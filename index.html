
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>BBCMA Gender Audit Survey - Media Institutions (Sierra Leone)</title>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            background-color: #ffffff;
            font-family: 'Oswald', Arial, sans-serif;
            color: #000000;
            font-weight: 700;
            padding: 20px;
        }

        /* ============================================ */
        /* LOGIN SCREEN */
        /* ============================================ */
        .login-screen {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .login-container {
            width: 100%;
            max-width: 650px;
            margin: 0 auto;
        }

        .login-header {
            background-color: #004080;
            color: #ffffff;
            padding: 25px 30px;
            text-align: center;
        }

        .login-header img {
            width: 140px;
            vertical-align: middle;
            border: none;
            border-radius: 8px;
        }

        .login-header h3 {
            margin: 12px 0 5px;
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 1px;
            color: #ffffff;
        }

        .login-header p {
            margin: 0;
            font-size: 10px;
            font-weight: 700;
            color: #ffffff;
        }

        .login-body {
            border: 4px double #004080;
            border-radius: 12px;
            padding: 12px;
            background-color: #ffffff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-top: 10px;
        }

        .login-content {
            padding: 35px;
        }

        .login-title {
            font-size: 17px;
            color: #000000;
            margin-bottom: 20px;
            font-weight: 700;
            text-align: center;
        }

        .login-subtitle {
            font-size: 16px;
            color: #000000;
            line-height: 1.8;
            margin-bottom: 30px;
            font-weight: 700;
            text-align: center;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-label {
            display: block;
            font-weight: 700;
            margin-bottom: 8px;
            color: #000000;
            font-size: 14px;
            letter-spacing: 0.5px;
        }

        .login-input {
            width: 100%;
            padding: 12px 16px;
            background: #f8f9fa;
            border: 2px solid #004080;
            border-radius: 6px;
            color: #000000;
            font-size: 16px;
            font-family: 'Oswald', Arial, sans-serif;
            font-weight: 700;
        }

        .login-input:focus {
            outline: none;
            border-color: #6B1C7C;
        }

        .login-btn {
            width: 100%;
            padding: 14px 24px;
            background: #004080;
            color: #ffffff;
            border: 2px solid #004080;
            border-radius: 6px;
            font-size: 16px;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 10px;
            font-family: 'Oswald', Arial, sans-serif;
        }

        .login-btn:hover {
            background: #0056b3;
            color: #ffffff;
        }

        .login-error {
            background: rgba(220, 53, 69, 0.1);
            border: 2px solid #dc3545;
            color: #dc3545;
            padding: 12px;
            border-radius: 6px;
            margin-bottom: 20px;
            font-size: 14px;
            display: none;
            font-weight: 700;
        }

        .login-error.show {
            display: block;
        }

        .login-footer {
            background-color: #004080;
            color: #ffffff;
            padding: 20px 30px;
            text-align: center;
            font-size: 13px;
            line-height: 1.7;
            font-weight: 700;
            margin-top: 10px;
        }

        .login-footer p {
            margin: 6px 0 0;
            font-size: 12px;
            color: #ffffff;
        }

        /* ============================================ */
        /* MAIN CONTENT */
        /* ============================================ */
        .main-content {
            display: none;
        }

        .main-content.show {
            display: block;
        }

        .page-container {
            width: 100%;
            max-width: 650px;
            margin: 0 auto;
        }

        /* HEADER */
        .page-header {
            background-color: #004080;
            color: #ffffff;
            padding: 25px 30px;
            text-align: center;
            margin-bottom: 10px;
        }

        .page-header img {
            width: 140px;
            vertical-align: middle;
            border: none;
            border-radius: 8px;
        }

        .page-header h3 {
            margin: 12px 0 5px;
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 1px;
            color: #ffffff;
        }

        .page-header .tagline {
            margin: 0;
            font-size: 10px;
            font-weight: 700;
            color: #ffffff;
        }

        .page-header h1 {
            margin: 20px 0 10px;
            font-size: 20px;
            font-weight: 700;
            color: #ffffff;
            letter-spacing: 1px;
        }

        .page-header .subtitle {
            font-size: 13px;
            color: #ffffff;
            font-weight: 700;
        }

        /* CONTROLS */
        .controls-bar {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .control-btn {
            background: #004080;
            color: #ffffff;
            border: 2px solid #004080;
            padding: 10px 20px;
            border-radius: 6px;
            font-size: 13px;
            cursor: pointer;
            font-weight: 700;
            font-family: 'Oswald', Arial, sans-serif;
            letter-spacing: 0.5px;
        }

        .control-btn:hover {
            background: #0056b3;
            border-color: #0056b3;
            color: #ffffff;
        }

        .control-btn.draft-btn {
            background: #ffc107;
            border-color: #ffc107;
            color: #000000;
        }

        .control-btn.draft-btn:hover {
            background: #e0a800;
            border-color: #e0a800;
        }

        /* STATUS BAR */
        .status-bar {
            background: #ffffff;
            border: 2px solid #004080;
            border-radius: 8px;
            padding: 15px 20px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }

        .status-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .status-indicator {
            width: 12px;
            height: 12px;
            border-radius: 50%;
        }

        .status-indicator.online {
            background: #28a745;
        }

        .status-indicator.offline {
            background: #dc3545;
        }

        .status-text {
            font-weight: 700;
            font-size: 14px;
            color: #000000;
        }

        .pending-count {
            background: #004080;
            color: #ffffff;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            border: 2px solid #004080;
        }

        .draft-count {
            background: #ffc107;
            color: #000000;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            border: 2px solid #ffc107;
        }

        /* FORM CARD */
        .form-card {
            border: 4px double #004080;
            border-radius: 12px;
            padding: 12px;
            background-color: #ffffff;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }

        .form-content {
            padding: 35px;
        }

        /* PROGRESS */
        .progress-bar {
            background: #f8f9fa;
            height: 8px;
            border-radius: 4px;
            margin-bottom: 15px;
            overflow: hidden;
            border: 2px solid #004080;
        }

        .progress-fill {
            background: linear-gradient(90deg, #004080, #0056b3);
            height: 100%;
            transition: width 0.3s ease;
        }

        .progress-text {
            text-align: center;
            color: #000000;
            font-size: 12px;
            margin-bottom: 25px;
            font-weight: 700;
        }

        /* SECTION */
        .form-section {
            display: none;
        }

        .form-section.active {
            display: block;
        }

        .section-header {
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 2px solid #004080;
        }

        .section-title {
            font-size: 18px;
            font-weight: 700;
            color: #004080;
            margin-bottom: 5px;
            letter-spacing: 0.5px;
        }

        .section-description {
            color: #000000;
            font-size: 13px;
            font-weight: 700;
        }

        /* FORM ELEMENTS */
        .form-group {
            margin-bottom: 25px;
            width: 100%;
        }

        .form-label {
            display: block;
            font-weight: 700;
            margin-bottom: 8px;
            color: #000000;
            font-size: 14px;
            letter-spacing: 0.5px;
        }

        .form-label .required {
            color: #dc3545;
        }

        .form-input,
        .form-select,
        .form-textarea {
            width: 100%;
            padding: 12px 16px;
            background: #f8f9fa;
            border: 2px solid #004080;
            border-radius: 6px;
            color: #000000;
            font-size: 16px;
            font-family: 'Oswald', Arial, sans-serif;
            font-weight: 700;
        }

        .form-input:focus,
        .form-select:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #004080;
        }

        .form-select:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            background: #e9ecef;
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
        }

        /* CHECKBOX GROUP */
        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .checkbox-item label {
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
        }

        /* RADIO GROUP */
        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .radio-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .radio-item input[type="radio"] {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .radio-item label {
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
        }

        /* SIGNATURE PAD */
        .signature-container {
            border: 2px solid #004080;
            border-radius: 6px;
            background: #ffffff;
            padding: 10px;
            margin-top: 10px;
        }

        .signature-canvas {
            width: 100%;
            height: 150px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            background: #ffffff;
            touch-action: none;
            cursor: crosshair;
        }

        .signature-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .signature-btn {
            padding: 8px 16px;
            background: #dc3545;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Oswald', Arial, sans-serif;
            letter-spacing: 0.5px;
        }

        .signature-btn:hover {
            background: #c82333;
        }

        /* GPS LOCATION */
        .gps-container {
            background: #e7f3ff;
            border: 2px solid #004080;
            border-radius: 6px;
            padding: 15px;
            margin-top: 10px;
        }

        .gps-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .gps-icon {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #6c757d;
        }

        .gps-icon.loading {
            background: #ffc107;
            animation: pulse 1s ease-in-out infinite;
        }

        .gps-icon.success {
            background: #28a745;
        }

        .gps-icon.error {
            background: #dc3545;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .gps-info {
            font-size: 12px;
            color: #000000;
            font-weight: 700;
        }

        .gps-coords {
            font-size: 11px;
            color: #004080;
            font-weight: 700;
            font-family: monospace;
        }

        .gps-btn {
            padding: 8px 16px;
            background: #004080;
            color: #ffffff;
            border: none;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Oswald', Arial, sans-serif;
            letter-spacing: 0.5px;
            margin-top: 10px;
        }

        .gps-btn:hover {
            background: #0056b3;
        }

        .gps-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* NAVIGATION */
        .navigation-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .btn-nav {
            flex: 1;
            padding: 14px 24px;
            border: 2px solid #004080;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-family: 'Oswald', Arial, sans-serif;
            min-width: 120px;
        }

        .btn-back {
            background: #ffffff;
            color: #004080;
        }

        .btn-back:hover {
            background: #004080;
            color: #ffffff;
        }

        .btn-next {
            background: #004080;
            color: #ffffff;
        }

        .btn-next:hover {
            background: #0056b3;
            border-color: #0056b3;
            color: #ffffff;
        }

        .btn-draft {
            background: #ffc107;
            color: #000000;
            border-color: #ffc107;
        }

        .btn-draft:hover {
            background: #e0a800;
            border-color: #e0a800;
        }

        .btn-finalize {
            background: #17a2b8;
            color: #ffffff;
            border-color: #17a2b8;
        }

        .btn-finalize:hover {
            background: #138496;
            border-color: #138496;
        }

        .btn-submit {
            background: #28a745;
            color: #ffffff;
            border-color: #28a745;
        }

        .btn-submit:hover:not(:disabled) {
            background: #218838;
            border-color: #218838;
            color: #ffffff;
        }

        .btn-submit:disabled,
        .btn-finalize:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        /* FOOTER */
        .page-footer {
            background-color: #004080;
            color: #ffffff;
            padding: 20px 30px;
            text-align: center;
            font-size: 13px;
            line-height: 1.7;
            font-weight: 700;
        }

        .page-footer p {
            margin: 6px 0 0;
            font-size: 12px;
            color: #ffffff;
        }

        /* NOTIFICATION */
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #ffffff;
            border: 2px solid #004080;
            padding: 16px 20px;
            border-radius: 8px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15);
            display: none;
            z-index: 1000;
            max-width: 400px;
        }

        .notification.show {
            display: block;
        }

        .notification.success {
            border-left: 4px solid #28a745;
        }

        .notification.error {
            border-left: 4px solid #dc3545;
        }

        .notification.info {
            border-left: 4px solid #004080;
        }

        .notification.warning {
            border-left: 4px solid #ffc107;
        }

        .notification-text {
            color: #000000;
            font-size: 14px;
            font-weight: 700;
        }

        /* DRAFTS MODAL */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 2000;
            padding: 20px;
        }

        .modal-overlay.show {
            display: flex;
        }

        .modal-content {
            background: #ffffff;
            border-radius: 12px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            border: 4px double #004080;
        }

        .modal-header {
            background: #004080;
            color: #ffffff;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 700;
        }

        .modal-close {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 24px;
            cursor: pointer;
            font-weight: 700;
        }

        .modal-body {
            padding: 20px;
        }

        .draft-item {
            background: #f8f9fa;
            border: 2px solid #004080;
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .draft-item-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .draft-item-title {
            font-weight: 700;
            color: #004080;
            font-size: 16px;
        }

        .draft-item-subtitle {
            font-size: 13px;
            color: #666;
            margin-top: 4px;
        }

        .draft-item-date {
            font-size: 12px;
            color: #6c757d;
        }

        .draft-item-actions {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }

        .draft-action-btn {
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 12px;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Oswald', Arial, sans-serif;
            border: none;
        }

        .draft-action-btn.load {
            background: #004080;
            color: #ffffff;
        }

        .draft-action-btn.delete {
            background: #dc3545;
            color: #ffffff;
        }

        .no-drafts {
            text-align: center;
            color: #6c757d;
            padding: 40px;
            font-size: 14px;
        }

        /* Draft Name Modal */
        .draft-name-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            padding: 20px;
        }

        .draft-name-modal.show {
            display: flex;
        }

        .draft-name-content {
            background: #ffffff;
            border-radius: 12px;
            max-width: 500px;
            width: 100%;
            border: 4px double #004080;
        }

        .draft-name-header {
            background: #ffc107;
            color: #000000;
            padding: 20px;
            border-radius: 8px 8px 0 0;
        }

        .draft-name-title {
            font-size: 18px;
            font-weight: 700;
            margin: 0;
        }

        .draft-name-body {
            padding: 30px;
        }

        .draft-name-label {
            display: block;
            font-weight: 700;
            margin-bottom: 10px;
            color: #000000;
            font-size: 14px;
        }

        .draft-name-input {
            width: 100%;
            padding: 12px 16px;
            background: #f8f9fa;
            border: 2px solid #004080;
            border-radius: 6px;
            color: #000000;
            font-size: 16px;
            font-family: 'Oswald', Arial, sans-serif;
            font-weight: 700;
            margin-bottom: 20px;
        }

        .draft-name-input:focus {
            outline: none;
            border-color: #ffc107;
        }

        .draft-name-buttons {
            display: flex;
            gap: 10px;
        }

        .draft-name-btn {
            flex: 1;
            padding: 12px 20px;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 700;
            cursor: pointer;
            font-family: 'Oswald', Arial, sans-serif;
            text-transform: uppercase;
            border: 2px solid;
        }

        .draft-name-btn.cancel {
            background: #ffffff;
            color: #004080;
            border-color: #004080;
        }

        .draft-name-btn.cancel:hover {
            background: #f8f9fa;
        }

        .draft-name-btn.save {
            background: #ffc107;
            color: #000000;
            border-color: #ffc107;
        }

        .draft-name-btn.save:hover {
            background: #e0a800;
            border-color: #e0a800;
        }

        /* Form Status Badge */
        .form-status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 700;
            margin-left: 10px;
        }

        .form-status-badge.draft {
            background: #ffc107;
            color: #000000;
        }

        .form-status-badge.finalized {
            background: #17a2b8;
            color: #ffffff;
        }

        /* ANALYSIS DASHBOARD */
        .analysis-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 3000;
            padding: 20px;
            overflow-y: auto;
        }

        .analysis-modal.show {
            display: flex;
        }

        .analysis-content {
            background: #ffffff;
            border-radius: 12px;
            max-width: 1200px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            border: 4px double #004080;
            margin: auto;
        }

        .analysis-header {
            background: #004080;
            color: #ffffff;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .analysis-title {
            font-size: 20px;
            font-weight: 700;
        }

        .analysis-close {
            background: none;
            border: none;
            color: #ffffff;
            font-size: 28px;
            cursor: pointer;
            font-weight: 700;
            line-height: 1;
        }

        .analysis-body {
            padding: 30px;
        }

        .analysis-loading {
            text-align: center;
            padding: 60px 20px;
            font-size: 16px;
            color: #666;
        }

        .analysis-error {
            background: #fff3cd;
            border: 2px solid #ffc107;
            color: #856404;
            padding: 20px;
            border-radius: 8px;
            margin: 20px;
            text-align: center;
            font-weight: 700;
        }

        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: #f8f9fa;
            border: 2px solid #004080;
            border-radius: 8px;
            padding: 20px;
            text-align: center;
        }

        .stat-value {
            font-size: 36px;
            font-weight: 700;
            color: #004080;
            margin: 10px 0;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
            font-weight: 700;
        }

        .stat-sublabel {
            font-size: 12px;
            color: #999;
            margin-top: 5px;
        }

        .chart-container {
            background: #ffffff;
            border: 2px solid #004080;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .chart-title {
            font-size: 18px;
            font-weight: 700;
            color: #004080;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e9ecef;
        }

        .chart-canvas {
            max-height: 400px;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .form-content,
            .login-content {
                padding: 25px;
            }

            .controls-bar {
                flex-direction: column;
            }

            .status-bar {
                flex-direction: column;
                gap: 10px;
            }

            .notification {
                left: 20px;
                right: 20px;
            }

            .navigation-buttons {
                flex-direction: column;
            }

            .btn-nav {
                width: 100%;
            }

            .dashboard-grid {
                grid-template-columns: 1fr;
            }

            .analysis-body {
                padding: 15px;
            }
        }
    </style>
</head>
<body>
    <!-- ============================================ -->
    <!-- LOGIN SCREEN -->
    <!-- ============================================ -->
    <div class="login-screen" id="loginScreen">
        <div class="login-container">
            <!-- HEADER -->
            <div class="login-header">
                <img src="https://github.com/mohamedsillahkanu/gdp-dashboard-2/raw/6c7463b0d5c3be150aafae695a4bcbbd8aeb1499/ICF-SL.jpg" alt="ICF-SL Logo">
                <h3>Informatics Consultancy Firm-Sierra Leone<br>(ICF-SL)</h3>
                <p><em>Driving Data-Driven Solutions for Health and Development</em></p>
            </div>

            <!-- BODY -->
            <div class="login-body">
                <div class="login-content">
                    <h2 class="login-title">GENDER AUDIT SURVEY</h2>
                    <p class="login-subtitle">Gender Audit Survey in Media Institutions<br>(Sierra Leone)</p>

                    <div class="login-error" id="loginError">Invalid username or password</div>

                    <form id="loginForm">
                        <div class="login-form-group">
                            <label class="login-label">USERNAME</label>
                            <input type="text" class="login-input" id="username" required autocomplete="username">
                        </div>

                        <div class="login-form-group">
                            <label class="login-label">PASSWORD</label>
                            <input type="password" class="login-input" id="password" required autocomplete="current-password">
                        </div>

                        <button type="submit" class="login-btn">LOGIN</button>
                    </form>
                </div>
            </div>

            <!-- FOOTER -->
            <div class="login-footer">
                <p style="margin: 0;">Gender Audit Survey in Media Institutions</p>
                <p>Informatics Consultancy Firm-Sierra Leone (ICF-SL)</p>
                <p style="font-size: 11px;">Freetown, Sierra Leone</p>
                <p style="font-size: 10px;">¬© 2025 Informatics Consultancy Firm-Sierra Leone (ICF-SL)</p>
            </div>
        </div>
    </div>

    <!-- ============================================ -->
    <!-- MAIN CONTENT -->
    <!-- ============================================ -->
    <div class="main-content" id="mainContent">
        <div class="page-container">
            <!-- HEADER -->
            <div class="page-header">
                <img src="https://github.com/mohamedsillahkanu/gdp-dashboard-2/raw/6c7463b0d5c3be150aafae695a4bcbbd8aeb1499/ICF-SL.jpg" alt="ICF-SL Logo">
                <h3>Informatics Consultancy Firm-Sierra Leone<br>(ICF-SL)</h3>
                <p class="tagline"><em>Driving Data-Driven Solutions for Health and Development</em></p>
                <h1>GENDER AUDIT SURVEY</h1>
                <p class="subtitle">Media Institutions - Sierra Leone</p>
            </div>

            <!-- CONTROLS -->
            <div class="controls-bar">
                <button class="control-btn" id="viewDataBtn">üìä VIEW DATA</button>
                <button class="control-btn" id="viewAnalysisBtn">üìà VIEW ANALYSIS</button>
                <button class="control-btn draft-btn" id="viewDraftsBtn">üìù VIEW DRAFTS</button>
                <button class="control-btn" id="logoutBtn">LOGOUT</button>
            </div>

            <!-- STATUS BAR -->
            <div class="status-bar">
                <div class="status-item">
                    <div class="status-indicator" id="statusIndicator"></div>
                    <span class="status-text" id="statusText">CHECKING...</span>
                </div>
                <div class="status-item">
                    <span style="color: #000000; font-size: 12px;">DRAFTS:</span>
                    <span class="draft-count" id="draftCount">0</span>
                </div>
                <div class="status-item">
                    <span style="color: #000000; font-size: 12px;">PENDING:</span>
                    <span class="pending-count" id="pendingCount">0</span>
                </div>
            </div>

            <!-- FORM CARD -->
            <div class="form-card">
                <div class="form-content">
                    <div class="progress-bar">
                        <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                    </div>
                    <div class="progress-text" id="progressText">SECTION 1 OF 6 <span id="formStatusBadge"></span></div>

                    <form id="dataForm">
                        <input type="hidden" name="form_status" id="form_status" value="draft">
                        <input type="hidden" name="draft_id" id="draft_id" value="">
                        <div id="dynamicSections"></div>
                    </form>
                </div>
            </div>

            <!-- FOOTER -->
            <div class="page-footer">
                <p style="margin: 0;">Gender Audit Survey in Media Institutions</p>
                <p>Informatics Consultancy Firm-Sierra Leone (ICF-SL)</p>
                <p style="font-size: 11px;">Freetown, Sierra Leone</p>
                <p style="font-size: 10px;">¬© 2025 Informatics Consultancy Firm-Sierra Leone (ICF-SL)</p>
            </div>
        </div>
    </div>

    <!-- DRAFTS MODAL -->
    <div class="modal-overlay" id="draftsModal">
        <div class="modal-content">
            <div class="modal-header">
                <span class="modal-title">üìù SAVED DRAFTS</span>
                <button class="modal-close" onclick="closeDraftsModal()">&times;</button>
            </div>
            <div class="modal-body" id="draftsModalBody">
                <!-- Drafts will be loaded here -->
            </div>
        </div>
    </div>

    <!-- DRAFT NAME MODAL -->
    <div class="draft-name-modal" id="draftNameModal">
        <div class="draft-name-content">
            <div class="draft-name-header">
                <h3 class="draft-name-title">üíæ SAVE DRAFT</h3>
            </div>
            <div class="draft-name-body">
                <label class="draft-name-label">ENTER A NAME FOR THIS DRAFT:</label>
                <input type="text" class="draft-name-input" id="draftNameInput" placeholder="e.g., ABC Media - January 2025">
                <div class="draft-name-buttons">
                    <button class="draft-name-btn cancel" onclick="cancelDraftName()">CANCEL</button>
                    <button class="draft-name-btn save" onclick="confirmSaveDraft()">SAVE DRAFT</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ANALYSIS DASHBOARD MODAL -->
    <div class="analysis-modal" id="analysisModal">
        <div class="analysis-content">
            <div class="analysis-header">
                <span class="analysis-title">üìà GENDER AUDIT ANALYSIS DASHBOARD</span>
                <button class="analysis-close" onclick="closeAnalysisModal()">&times;</button>
            </div>
            <div class="analysis-body" id="analysisBody">
                <div class="analysis-loading">
                    <p>Loading analysis data...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- NOTIFICATION -->
    <div class="notification" id="notification">
        <span class="notification-text" id="notificationText"></span>
    </div>

    <script>
        // ============================================
        // CONFIGURATION
        // ============================================
        const CONFIG = {
            SCRIPT_URL: 'YOUR_GOOGLE_APPS_SCRIPT_URL_HERE',
            GOOGLE_SHEET_URL: 'YOUR_GOOGLE_SHEET_URL_HERE',
            LOGIN_USERNAME: 'admin',
            LOGIN_PASSWORD: 'admin123',
            SHEETS: {
                SURVEY_DATA: 'SURVEY_DATA',
                SUMMARY: 'SUMMARY_REPORT'
            }
        };

        // ============================================
        // SIERRA LEONE DISTRICTS
        // ============================================
        const DISTRICTS = [
            'Bo District',
            'Bombali District',
            'Bonthe District',
            'Falaba District',
            'Kailahun District',
            'Kambia District',
            'Karene District',
            'Kenema District',
            'Koinadugu District',
            'Kono District',
            'Moyamba District',
            'Port Loko District',
            'Pujehun District',
            'Tonkolili District',
            'Western Area Rural District',
            'Western Area Urban District'
        ];

        // ============================================
        // FORM SECTIONS DEFINITION
        // ============================================
        const FORM_SECTIONS = {
            'Section A: Media Institution Profile': {
                description: 'Basic information about the media institution',
                fields: {
                    media_house_name: { label: 'Name of Media House', type: 'text' },
                    media_type: { 
                        label: 'Type of Media', 
                        type: 'checkbox',
                        options: ['Print', 'Radio', 'Television', 'Online/Digital']
                    },
                    address: { label: 'Address', type: 'text' },
                    district: { 
                        label: 'District', 
                        type: 'select',
                        options: DISTRICTS
                    },
                    owner_gender: { 
                        label: 'Gender identity of the owner of the media institution', 
                        type: 'radio',
                        options: ['Male', 'Female', "Don't know"]
                    },
                    year_established: { label: 'Year of establishment', type: 'number' },
                    region: { 
                        label: 'Region', 
                        type: 'radio',
                        options: ['Western Area', 'Northern', 'Southern', 'Eastern', 'North-Western']
                    }
                }
            },
            'Section B: Workforce Gender Composition': {
                description: 'Employee numbers and gender composition',
                fields: {
                    total_employees: { label: 'Q1. Total number of employees', type: 'number' },
                    total_female_employees: { label: 'Q2. Total number of female employees', type: 'number' },
                    total_male_employees: { label: 'Q3. Total number of male employees', type: 'number' },
                    first_female_hire: { 
                        label: 'Q4. When did your organisation first hire a female staff?', 
                        type: 'radio',
                        options: ['Six months ago', 'One year ago', 'Two years ago', 'Three years ago', 'Four years ago', 'Five years +']
                    }
                }
            },
            'Section E: Representation Across Different Positions': {
                description: 'Staff distribution across different roles and departments',
                fields: {
                    leadership_women: { label: 'Q5. Staff in Leadership/Managerial positions - Total number of women', type: 'number' },
                    leadership_men: { label: 'Q5. Staff in Leadership/Managerial positions - Total number of men', type: 'number' },
                    non_managerial_women: { label: 'Q6. Staff in Non-Managerial/Leadership positions - Total number of women', type: 'number' },
                    non_managerial_men: { label: 'Q6. Staff in Non-Managerial/Leadership positions - Total number of men', type: 'number' },
                    technical_women: { label: 'Q7. Technical Unit (Camera team, IT, Graphics, etc.) - Total number of women', type: 'number' },
                    technical_men: { label: 'Q7. Technical Unit (Camera team, IT, Graphics, etc.) - Total number of men', type: 'number' },
                    operations_women: { label: 'Q8. Operations/Administration/HR/Finance Unit - Total number of women', type: 'number' },
                    operations_men: { label: 'Q8. Operations/Administration/HR/Finance Unit - Total number of men', type: 'number' },
                    newsroom_women: { label: 'Q9. Newsroom/Field/Reporting Unit - Total number of women', type: 'number' },
                    newsroom_men: { label: 'Q9. Newsroom/Field/Reporting Unit - Total number of men', type: 'number' }
                }
            },
            'Section C: Entry and Retention': {
                description: 'Recruitment and retention of women employees',
                fields: {
                    women_recruited_12months: { 
                        label: 'Q10. How many women were recruited into your organization in the last 12 months?', 
                        type: 'radio',
                        options: ['None', '1‚Äì2', '3‚Äì5', '6‚Äì10', 'More than 10', "Don't know"]
                    },
                    women_retained_3years: { 
                        label: 'Q11. How many women have remained in your organization for more than 3 years?', 
                        type: 'radio',
                        options: ['None', '1‚Äì2', '3‚Äì5', '6‚Äì10', 'More than 10', "Don't know"]
                    },
                    women_face_barriers: { 
                        label: 'Q12. Do women face barriers to be recruited in your institution?', 
                        type: 'radio',
                        options: ['Yes', 'No']
                    },
                    entry_barriers: { 
                        label: 'Q13. What barriers do women face at entry level? (Select all that apply)', 
                        type: 'checkbox',
                        options: [
                            'Women hardly apply',
                            'Lack of mentorship/training opportunities',
                            'Limited job openings',
                            'Social expectations',
                            'Family Pressure',
                            'Lower starting pay compared to men',
                            'Other'
                        ],
                        required: false
                    },
                    entry_barriers_other: { label: 'If Other, Please Specify', type: 'text', required: false },
                    equal_retention: { 
                        label: 'Q14. Do women journalists in your media institution have equal chances of being retained compared to men?', 
                        type: 'radio',
                        options: ['Strongly Agree', 'Agree', 'Neutral', 'Disagree', 'Strongly Disagree']
                    }
                }
            },
            'Section D: Attrition of Women': {
                description: 'Departure patterns and reasons for women leaving',
                fields: {
                    women_left_12months: { 
                        label: 'Q15. In the last 12 months, how many women employees have left your institution?', 
                        type: 'radio',
                        options: ['None', '1‚Äì2', '3‚Äì5', '6‚Äì10', 'More than 10', "Don't know"]
                    },
                    departure_reasons: { 
                        label: 'Q16. What were the main reasons for their departure? (Select all that apply)', 
                        type: 'checkbox',
                        options: [
                            'Harassment',
                            'Discrimination',
                            'Lack of career growth opportunities',
                            'Low pay or poor benefits',
                            'Family responsibilities (e.g., childcare, household duties)',
                            'Unsafe working conditions (e.g., field assignments, lack of social security - NASSIT, long working hours, lack of medical insurance)',
                            'Better opportunities elsewhere',
                            'Organizational restructuring or layoffs',
                            'Other'
                        ],
                        required: false
                    },
                    departure_reasons_other: { label: 'If Other, Please Specify', type: 'text', required: false },
                    career_stage_departure: { 
                        label: 'Q17. At what stage of their career did most women leave your media institution?', 
                        type: 'radio',
                        options: ['Entry-level', 'Mid-level', 'Senior-level', "Don't know"],
                        required: false
                    },
                    average_stay_duration: { 
                        label: 'Q18. How long, on average, do women stay before leaving your media institution?', 
                        type: 'radio',
                        options: ['Less than 1 year', '1‚Äì2 years', '3‚Äì5 years', 'More than 5 years', "Don't know"],
                        required: false
                    },
                    higher_attrition_rate: { 
                        label: 'Q19. Women leave at a higher rate than men in your media institution.', 
                        type: 'radio',
                        options: ['Strongly Agree', 'Agree', 'Neutral', 'Disagree', 'Strongly Disagree'],
                        required: false
                    },
                    attrition_impact: { 
                        label: 'Q20. What impact does attrition of women have on your media institution? (Select all that apply)', 
                        type: 'checkbox',
                        options: [
                            'Loss of skilled staff',
                            'Reduced diversity in reporting',
                            'Increased recruitment costs',
                            'Negative impact on organizational reputation',
                            'No significant impact',
                            'Other'
                        ],
                        required: false
                    },
                    attrition_impact_other: { label: 'If Other, Please Specify', type: 'text', required: false }
                }
            },
            'Respondent Information & Signature': {
                description: 'Information about the person completing this survey',
                fields: {
                    respondent_name: { label: 'Name of Respondent', type: 'text' },
                    respondent_position: { label: 'Position/Title', type: 'text' },
                    respondent_contact: { label: 'Contact Number', type: 'tel' },
                    respondent_email: { label: 'Email Address', type: 'email', required: false },
                    survey_date: { label: 'Date of Survey', type: 'date' },
                    respondent_signature: { label: 'Signature', type: 'signature' },
                    gps_location: { label: 'GPS Location (Optional)', type: 'gps', required: false }
                }
            }
        };

        // ============================================
        // STATE
        // ============================================
        const state = {
            pendingSubmissions: [],
            drafts: [],
            isOnline: navigator.onLine,
            isLoggedIn: false,
            currentSection: 1,
            totalSections: 0,
            signaturePads: {},
            gpsLocation: null,
            formStatus: 'draft',
            currentDraftId: null,
            currentDraftName: null
        };

        // ============================================
        // INITIALIZATION
        // ============================================
        function init() {
            // Load pending submissions
            const savedPending = localStorage.getItem('pendingSubmissions');
            if (savedPending) {
                try {
                    state.pendingSubmissions = JSON.parse(savedPending);
                } catch (e) {
                    state.pendingSubmissions = [];
                }
            }

            // Load drafts
            const savedDrafts = localStorage.getItem('formDrafts');
            if (savedDrafts) {
                try {
                    state.drafts = JSON.parse(savedDrafts);
                } catch (e) {
                    state.drafts = [];
                }
            }

            state.isLoggedIn = sessionStorage.getItem('isLoggedIn') === 'true';
            
            if (state.isLoggedIn) {
                showMainContent();
            }

            setupEventListeners();
            generateFormSections();
        }

        function generateFormSections() {
            const container = document.getElementById('dynamicSections');
            let html = '';
            let sectionNum = 1;
            
            const sectionKeys = Object.keys(FORM_SECTIONS);
            state.totalSections = sectionKeys.length;
            
            sectionKeys.forEach((sectionTitle, index) => {
                const section = FORM_SECTIONS[sectionTitle];
                const isLastSection = index === sectionKeys.length - 1;
                
                html += `
                    <div class="form-section ${sectionNum === 1 ? 'active' : ''}" data-section="${sectionNum}">
                        <div class="section-header">
                            <h2 class="section-title">${sectionTitle.toUpperCase()}</h2>
                            <p class="section-description">${section.description}</p>
                        </div>
                `;
                
                // Generate fields
                const fields = Object.entries(section.fields);
                fields.forEach(([fieldName, fieldConfig]) => {
                    const label = fieldConfig.label;
                    const type = fieldConfig.type || 'text';
                    const required = fieldConfig.required !== false;
                    
                    html += '<div class="form-group">';
                    html += `<label class="form-label">${label.toUpperCase()} ${required ? '<span class="required">*</span>' : ''}</label>`;
                    
                    if (type === 'signature') {
                        // Signature pad
                        html += `
                            <div class="signature-container">
                                <canvas class="signature-canvas" id="${fieldName}_canvas" data-field="${fieldName}"></canvas>
                                <div class="signature-controls">
                                    <button type="button" class="signature-btn" onclick="clearSignature('${fieldName}')">CLEAR</button>
                                </div>
                            </div>
                            <input type="hidden" name="${fieldName}" id="${fieldName}" ${required ? 'required' : ''}>
                        `;
                    } else if (type === 'gps') {
                        // GPS Location
                        html += `
                            <div class="gps-container">
                                <div class="gps-status">
                                    <div class="gps-icon" id="gps_icon"></div>
                                    <div>
                                        <div class="gps-info" id="gps_status">Click button to capture GPS location (Optional - 2 minute timeout)</div>
                                        <div class="gps-coords" id="gps_coords"></div>
                                    </div>
                                </div>
                                <button type="button" class="gps-btn" id="gps_capture_btn" onclick="captureGPS()">üìç CAPTURE GPS LOCATION</button>
                            </div>
                            <input type="hidden" name="gps_latitude" id="gps_latitude">
                            <input type="hidden" name="gps_longitude" id="gps_longitude">
                            <input type="hidden" name="gps_accuracy" id="gps_accuracy">
                            <input type="hidden" name="gps_timestamp" id="gps_timestamp">
                        `;
                    } else if (type === 'radio') {
                        html += '<div class="radio-group">';
                        fieldConfig.options.forEach((option, idx) => {
                            html += `
                                <div class="radio-item">
                                    <input type="radio" name="${fieldName}" id="${fieldName}_${idx}" value="${option}" ${required ? 'required' : ''}>
                                    <label for="${fieldName}_${idx}">${option}</label>
                                </div>
                            `;
                        });
                        html += '</div>';
                    } else if (type === 'checkbox') {
                        html += '<div class="checkbox-group">';
                        fieldConfig.options.forEach((option, idx) => {
                            html += `
                                <div class="checkbox-item">
                                    <input type="checkbox" name="${fieldName}" id="${fieldName}_${idx}" value="${option}">
                                    <label for="${fieldName}_${idx}">${option}</label>
                                </div>
                            `;
                        });
                        html += '</div>';
                    } else if (type === 'select' && fieldConfig.options) {
                        html += `<select class="form-select" name="${fieldName}" ${required ? 'required' : ''}>`;
                        html += '<option value="">Select...</option>';
                        fieldConfig.options.forEach(option => {
                            html += `<option value="${option}">${option}</option>`;
                        });
                        html += '</select>';
                    } else if (type === 'date') {
                        html += `<input type="date" class="form-input" name="${fieldName}" ${required ? 'required' : ''}>`;
                    } else if (type === 'number') {
                        html += `<input type="number" class="form-input" name="${fieldName}" min="0" step="1" ${required ? 'required' : ''}>`;
                    } else if (type === 'textarea') {
                        html += `<textarea class="form-textarea" name="${fieldName}" rows="4" ${required ? 'required' : ''}></textarea>`;
                    } else if (type === 'tel') {
                        html += `<input type="tel" class="form-input" name="${fieldName}" ${required ? 'required' : ''}>`;
                    } else if (type === 'email') {
                        html += `<input type="email" class="form-input" name="${fieldName}" ${required ? 'required' : ''}>`;
                    } else {
                        html += `<input type="text" class="form-input" name="${fieldName}" ${required ? 'required' : ''}>`;
                    }
                    
                    html += '</div>';
                });
                
                // Navigation buttons
                html += '<div class="navigation-buttons">';
                
                if (sectionNum > 1) {
                    html += '<button type="button" class="btn-nav btn-back" onclick="previousSection()">‚Üê BACK</button>';
                }
                
                // Always show Save as Draft button
                html += '<button type="button" class="btn-nav btn-draft" onclick="showDraftNameModal()">üíæ SAVE DRAFT</button>';
                
                if (isLastSection) {
                    // Last section: Show Finalize and Submit buttons
                    html += '<button type="button" class="btn-nav btn-finalize" id="finalizeBtn" onclick="finalizeForm()">‚úì FINALIZE</button>';
                    html += '<button type="submit" class="btn-nav btn-submit" id="submitBtn" disabled>üì§ SUBMIT</button>';
                } else {
                    html += '<button type="button" class="btn-nav btn-next" onclick="nextSection()">NEXT ‚Üí</button>';
                }
                
                html += '</div></div>';
                
                sectionNum++;
            });
            
            container.innerHTML = html;
            updateProgress();
            
            // Initialize signature pads after a short delay
            setTimeout(() => {
                initializeSignaturePads();
            }, 100);
        }

        function setupEventListeners() {
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            document.getElementById('viewDataBtn').addEventListener('click', handleViewData);
            document.getElementById('viewAnalysisBtn').addEventListener('click', openAnalysisModal);
            document.getElementById('viewDraftsBtn').addEventListener('click', openDraftsModal);
            document.getElementById('dataForm').addEventListener('submit', handleFormSubmit);
            window.addEventListener('online', handleOnlineEvent);
            window.addEventListener('offline', handleOfflineEvent);
            
            // Add enter key listener for draft name input
            document.getElementById('draftNameInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    confirmSaveDraft();
                }
            });
        }

        function nextSection() {
            const currentSectionEl = document.querySelector(`.form-section[data-section="${state.currentSection}"]`);
            const inputs = currentSectionEl.querySelectorAll('input[required], select[required], textarea[required]');
            let isValid = true;
            
            inputs.forEach(input => {
                if (input.type === 'radio') {
                    const radioGroup = currentSectionEl.querySelectorAll(`input[name="${input.name}"]`);
                    const isChecked = Array.from(radioGroup).some(radio => radio.checked);
                    if (!isChecked) {
                        isValid = false;
                        input.closest('.radio-group').style.borderLeft = '4px solid #dc3545';
                        setTimeout(() => input.closest('.radio-group').style.borderLeft = '', 3000);
                    }
                } else if (!input.value) {
                    isValid = false;
                    input.style.borderColor = '#dc3545';
                    setTimeout(() => input.style.borderColor = '', 3000);
                }
            });
            
            if (!isValid) {
                showNotification('Please fill in all required fields', 'error');
                return;
            }
            
            if (state.currentSection < state.totalSections) {
                currentSectionEl.classList.remove('active');
                state.currentSection++;
                const nextSection = document.querySelector(`.form-section[data-section="${state.currentSection}"]`);
                if (nextSection) {
                    nextSection.classList.add('active');
                    updateProgress();
                    window.scrollTo({ top: 0, behavior: 'smooth' });
                }
            }
        }

        function previousSection() {
            if (state.currentSection > 1) {
                document.querySelector(`.form-section[data-section="${state.currentSection}"]`).classList.remove('active');
                state.currentSection--;
                document.querySelector(`.form-section[data-section="${state.currentSection}"]`).classList.add('active');
                updateProgress();
                window.scrollTo({ top: 0, behavior: 'smooth' });
            }
        }

        function updateProgress() {
            const progress = (state.currentSection / state.totalSections) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
            
            let statusBadge = '';
            if (state.formStatus === 'draft') {
                statusBadge = '<span class="form-status-badge draft">DRAFT</span>';
            } else if (state.formStatus === 'finalized') {
                statusBadge = '<span class="form-status-badge finalized">FINALIZED</span>';
            }
            
            document.getElementById('progressText').innerHTML = `SECTION ${state.currentSection} OF ${state.totalSections} ${statusBadge}`;
        }

        function handleLogin(e) {
            e.preventDefault();
            
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value.trim();
            const errorDiv = document.getElementById('loginError');
            
            if (username === CONFIG.LOGIN_USERNAME && password === CONFIG.LOGIN_PASSWORD) {
                sessionStorage.setItem('isLoggedIn', 'true');
                sessionStorage.setItem('username', username);
                state.isLoggedIn = true;
                errorDiv.classList.remove('show');
                showMainContent();
            } else {
                errorDiv.classList.add('show');
            }
        }

        function handleLogout() {
            sessionStorage.removeItem('isLoggedIn');
            sessionStorage.removeItem('username');
            state.isLoggedIn = false;
            document.getElementById('mainContent').classList.remove('show');
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('username').value = '';
            document.getElementById('password').value = '';
        }

        function showMainContent() {
            document.getElementById('loginScreen').style.display = 'none';
            document.getElementById('mainContent').classList.add('show');
            updateOnlineStatus();
            updatePendingCount();
            updateDraftCount();
            
            if (state.isOnline && state.pendingSubmissions.length > 0) {
                syncPendingSubmissions();
            }
        }

        function handleViewData() {
            if (CONFIG.GOOGLE_SHEET_URL && CONFIG.GOOGLE_SHEET_URL !== 'YOUR_GOOGLE_SHEET_URL_HERE') {
                window.open(CONFIG.GOOGLE_SHEET_URL, '_blank');
            } else {
                showNotification('Please configure Google Sheet URL in the script', 'error');
            }
        }

        function handleOnlineEvent() {
            state.isOnline = true;
            updateOnlineStatus();
            showNotification('Back online - Syncing data...', 'info');
            syncPendingSubmissions();
        }

        function handleOfflineEvent() {
            state.isOnline = false;
            updateOnlineStatus();
            showNotification('You are offline - Data will be saved locally', 'info');
        }

        function updateOnlineStatus() {
            const indicator = document.getElementById('statusIndicator');
            const text = document.getElementById('statusText');
            
            if (state.isOnline) {
                indicator.className = 'status-indicator online';
                text.textContent = 'ONLINE';
            } else {
                indicator.className = 'status-indicator offline';
                text.textContent = 'OFFLINE';
            }
        }

        function updatePendingCount() {
            document.getElementById('pendingCount').textContent = state.pendingSubmissions.length;
        }

        function updateDraftCount() {
            document.getElementById('draftCount').textContent = state.drafts.length;
        }

        // ============================================
        // DRAFT MANAGEMENT WITH CUSTOM NAMES
        // ============================================
        function showDraftNameModal() {
            const modal = document.getElementById('draftNameModal');
            const input = document.getElementById('draftNameInput');
            
            // Set default name if editing existing draft
            if (state.currentDraftName) {
                input.value = state.currentDraftName;
            } else {
                // Generate default name based on form data
                const mediaHouse = document.querySelector('[name="media_house_name"]')?.value || '';
                const surveyDate = document.querySelector('[name="survey_date"]')?.value || '';
                const defaultName = mediaHouse || surveyDate || 'Unnamed Draft';
                input.value = defaultName;
            }
            
            modal.classList.add('show');
            input.focus();
            input.select();
        }

        function cancelDraftName() {
            const modal = document.getElementById('draftNameModal');
            modal.classList.remove('show');
        }

        function confirmSaveDraft() {
            const draftName = document.getElementById('draftNameInput').value.trim();
            
            if (!draftName) {
                showNotification('Please enter a name for the draft', 'warning');
                return;
            }
            
            // Close modal
            cancelDraftName();
            
            // Save draft with the provided name
            saveAsDraft(draftName);
        }

        function saveAsDraft(draftName) {
            const formData = new FormData(document.getElementById('dataForm'));
            
            const data = {
                draftId: state.currentDraftId || generateDraftId(),
                draftName: draftName,
                savedAt: new Date().toISOString(),
                savedBy: sessionStorage.getItem('username') || 'admin',
                formStatus: 'draft',
                currentSection: state.currentSection
            };
            
            for (const [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // Handle checkbox groups
            const checkboxGroups = {};
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                if (checkbox.checked) {
                    if (!checkboxGroups[checkbox.name]) {
                        checkboxGroups[checkbox.name] = [];
                    }
                    checkboxGroups[checkbox.name].push(checkbox.value);
                }
            });
            
            for (const [key, values] of Object.entries(checkboxGroups)) {
                data[key] = values.join(', ');
            }
            
            // Save signature data
            Object.keys(state.signaturePads).forEach(fieldName => {
                const pad = state.signaturePads[fieldName];
                if (pad && !pad.isEmpty()) {
                    data[fieldName] = pad.toDataURL();
                }
            });
            
            // Check if updating existing draft
            const existingIndex = state.drafts.findIndex(d => d.draftId === data.draftId);
            if (existingIndex !== -1) {
                state.drafts[existingIndex] = data;
            } else {
                state.drafts.push(data);
            }
            
            localStorage.setItem('formDrafts', JSON.stringify(state.drafts));
            state.currentDraftId = data.draftId;
            state.currentDraftName = draftName;
            document.getElementById('draft_id').value = data.draftId;
            
            updateDraftCount();
            showNotification(`Draft "${draftName}" saved successfully!`, 'success');
        }

        function generateDraftId() {
            return 'draft_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }

        function openDraftsModal() {
            const modal = document.getElementById('draftsModal');
            const modalBody = document.getElementById('draftsModalBody');
            
            if (state.drafts.length === 0) {
                modalBody.innerHTML = '<div class="no-drafts">No saved drafts</div>';
            } else {
                let html = '';
                // Sort drafts by savedAt date (newest first)
                const sortedDrafts = [...state.drafts].sort((a, b) => 
                    new Date(b.savedAt) - new Date(a.savedAt)
                );
                
                sortedDrafts.forEach((draft, index) => {
                    const savedDate = new Date(draft.savedAt).toLocaleString();
                    const draftName = draft.draftName || 'Unnamed Draft';
                    const mediaHouse = draft.media_house_name || '';
                    
                    html += `
                        <div class="draft-item">
                            <div class="draft-item-header">
                                <div>
                                    <div class="draft-item-title">${draftName}</div>
                                    ${mediaHouse ? `<div class="draft-item-subtitle">Media House: ${mediaHouse}</div>` : ''}
                                </div>
                                <div class="draft-item-date">Saved: ${savedDate}</div>
                            </div>
                            <div class="draft-item-actions">
                                <button class="draft-action-btn load" onclick="loadDraft('${draft.draftId}')">üìÇ LOAD</button>
                                <button class="draft-action-btn delete" onclick="deleteDraft('${draft.draftId}')">üóëÔ∏è DELETE</button>
                            </div>
                        </div>
                    `;
                });
                modalBody.innerHTML = html;
            }
            
            modal.classList.add('show');
        }

        function closeDraftsModal() {
            document.getElementById('draftsModal').classList.remove('show');
        }

        function loadDraft(draftId) {
            const draft = state.drafts.find(d => d.draftId === draftId);
            if (!draft) {
                showNotification('Draft not found', 'error');
                return;
            }
            
            // Clear form first
            clearForm(false);
            
            // Load draft data
            state.currentDraftId = draftId;
            state.currentDraftName = draft.draftName;
            state.formStatus = draft.formStatus || 'draft';
            document.getElementById('draft_id').value = draftId;
            document.getElementById('form_status').value = state.formStatus;
            
            // Populate form fields
            Object.keys(draft).forEach(key => {
                if (['draftId', 'draftName', 'savedAt', 'savedBy', 'formStatus', 'currentSection'].includes(key)) return;
                
                const field = document.querySelector(`[name="${key}"]`);
                if (field) {
                    if (field.type === 'hidden' && key.includes('signature')) {
                        // Handle signature fields
                        const canvas = document.getElementById(`${key}_canvas`);
                        if (canvas && draft[key]) {
                            const pad = state.signaturePads[key];
                            if (pad) {
                                const img = new Image();
                                img.onload = () => {
                                    const ctx = canvas.getContext('2d');
                                    ctx.drawImage(img, 0, 0);
                                };
                                img.src = draft[key];
                                field.value = draft[key];
                            }
                        }
                    } else if (field.type === 'radio') {
                        const radio = document.querySelector(`input[name="${key}"][value="${draft[key]}"]`);
                        if (radio) radio.checked = true;
                    } else if (field.type === 'checkbox') {
                        // Handle checkbox groups
                        if (draft[key]) {
                            const values = draft[key].split(', ');
                            values.forEach(val => {
                                const checkbox = document.querySelector(`input[name="${key}"][value="${val}"]`);
                                if (checkbox) checkbox.checked = true;
                            });
                        }
                    } else {
                        field.value = draft[key];
                    }
                }
            });
            
            // Go to saved section
            if (draft.currentSection) {
                document.querySelectorAll('.form-section').forEach(s => s.classList.remove('active'));
                state.currentSection = draft.currentSection;
                const targetSection = document.querySelector(`.form-section[data-section="${draft.currentSection}"]`);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
            }
            
            updateProgress();
            updateSubmitButton();
            closeDraftsModal();
            showNotification(`Draft "${draft.draftName}" loaded successfully!`, 'success');
        }

        function deleteDraft(draftId) {
            const draft = state.drafts.find(d => d.draftId === draftId);
            const draftName = draft ? draft.draftName : 'this draft';
            
            if (!confirm(`Are you sure you want to delete "${draftName}"?`)) return;
            
            state.drafts = state.drafts.filter(d => d.draftId !== draftId);
            localStorage.setItem('formDrafts', JSON.stringify(state.drafts));
            
            if (state.currentDraftId === draftId) {
                state.currentDraftId = null;
                state.currentDraftName = null;
                document.getElementById('draft_id').value = '';
            }
            
            updateDraftCount();
            openDraftsModal(); // Refresh modal
            showNotification('Draft deleted', 'info');
        }

        // ============================================
        // FINALIZE & SUBMIT
        // ============================================
        function finalizeForm() {
            // Validate all required fields across all sections
            let isValid = true;
            let firstInvalidSection = null;
            
            document.querySelectorAll('.form-section').forEach((section, index) => {
                const inputs = section.querySelectorAll('input[required], select[required], textarea[required]');
                inputs.forEach(input => {
                    if (input.type === 'radio') {
                        const radioGroup = section.querySelectorAll(`input[name="${input.name}"]`);
                        const isChecked = Array.from(radioGroup).some(radio => radio.checked);
                        if (!isChecked && firstInvalidSection === null) {
                            isValid = false;
                            firstInvalidSection = index + 1;
                        }
                    } else if (!input.value) {
                        isValid = false;
                        input.style.borderColor = '#dc3545';
                        if (firstInvalidSection === null) {
                            firstInvalidSection = index + 1;
                        }
                    }
                });
            });
            
            if (!isValid) {
                showNotification(`Please complete all required fields. Check Section ${firstInvalidSection}`, 'error');
                // Navigate to first invalid section
                document.querySelectorAll('.form-section').forEach(s => s.classList.remove('active'));
                state.currentSection = firstInvalidSection;
                document.querySelector(`.form-section[data-section="${firstInvalidSection}"]`).classList.add('active');
                updateProgress();
                return;
            }
            
            state.formStatus = 'finalized';
            document.getElementById('form_status').value = 'finalized';
            updateProgress();
            updateSubmitButton();
            
            // Auto-save draft with finalized status
            if (state.currentDraftName) {
                saveAsDraft(state.currentDraftName);
            } else {
                showDraftNameModal();
            }
            
            showNotification('Form finalized! You can now submit.', 'success');
        }

        function updateSubmitButton() {
            const submitBtn = document.getElementById('submitBtn');
            const finalizeBtn = document.getElementById('finalizeBtn');
            
            if (state.formStatus === 'finalized') {
                submitBtn.disabled = false;
                finalizeBtn.disabled = true;
                finalizeBtn.textContent = '‚úì FINALIZED';
            } else {
                submitBtn.disabled = true;
                finalizeBtn.disabled = false;
                finalizeBtn.textContent = '‚úì FINALIZE';
            }
        }

        async function handleFormSubmit(e) {
            e.preventDefault();
            e.stopPropagation();

            if (state.formStatus !== 'finalized') {
                showNotification('Please finalize the form before submitting', 'warning');
                return;
            }

            const formData = new FormData(e.target);
            
            const data = {
                timestamp: new Date().toISOString(),
                submittedBy: sessionStorage.getItem('username') || 'admin',
                form_status: 'submitted'
            };
            
            for (const [key, value] of formData.entries()) {
                data[key] = value;
            }
            
            // Handle checkbox groups
            const checkboxGroups = {};
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                if (checkbox.checked) {
                    if (!checkboxGroups[checkbox.name]) {
                        checkboxGroups[checkbox.name] = [];
                    }
                    checkboxGroups[checkbox.name].push(checkbox.value);
                }
            });
            
            for (const [key, values] of Object.entries(checkboxGroups)) {
                data[key] = values.join(', ');
            }

            if (state.isOnline) {
                await submitToServer(data);
            } else {
                saveOffline(data);
            }
        }

        async function submitToServer(data) {
            const submitBtn = document.getElementById('submitBtn');
            submitBtn.disabled = true;
            submitBtn.textContent = 'SUBMITTING...';

            try {
                const response = await fetch(CONFIG.SCRIPT_URL, {
                    method: 'POST',
                    mode: 'no-cors',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                // Remove from drafts if it was a draft
                if (state.currentDraftId) {
                    state.drafts = state.drafts.filter(d => d.draftId !== state.currentDraftId);
                    localStorage.setItem('formDrafts', JSON.stringify(state.drafts));
                    updateDraftCount();
                }

                showNotification('Data submitted successfully!', 'success');
                clearForm(true);
                
            } catch (error) {
                console.error('Submit error:', error);
                showNotification('Failed to submit - Saved offline', 'error');
                saveOffline(data);
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'üì§ SUBMIT';
            }
        }

        function saveOffline(data) {
            state.pendingSubmissions.push(data);
            localStorage.setItem('pendingSubmissions', JSON.stringify(state.pendingSubmissions));
            
            // Remove from drafts
            if (state.currentDraftId) {
                state.drafts = state.drafts.filter(d => d.draftId !== state.currentDraftId);
                localStorage.setItem('formDrafts', JSON.stringify(state.drafts));
                updateDraftCount();
            }
            
            updatePendingCount();
            showNotification('Data saved offline - Will sync when online', 'info');
            clearForm(true);
        }

        async function syncPendingSubmissions() {
            if (state.pendingSubmissions.length === 0) return;

            showNotification('Syncing pending submissions...', 'info');
            const successfulSyncs = [];
            
            for (let i = 0; i < state.pendingSubmissions.length; i++) {
                try {
                    await fetch(CONFIG.SCRIPT_URL, {
                        method: 'POST',
                        mode: 'no-cors',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify(state.pendingSubmissions[i])
                    });
                    successfulSyncs.push(i);
                } catch (error) {
                    console.error('Sync error:', error);
                }
            }

            if (successfulSyncs.length > 0) {
                state.pendingSubmissions = state.pendingSubmissions.filter((_, index) => 
                    !successfulSyncs.includes(index)
                );
                localStorage.setItem('pendingSubmissions', JSON.stringify(state.pendingSubmissions));
                updatePendingCount();
                showNotification(`Successfully synced ${successfulSyncs.length} submission(s)`, 'success');
            }
        }

        function clearForm(resetStatus = true) {
            document.getElementById('dataForm').reset();
            
            // Clear signature pads
            Object.keys(state.signaturePads).forEach(fieldName => {
                clearSignature(fieldName);
            });
            
            // Clear checkboxes
            document.querySelectorAll('input[type="checkbox"]').forEach(checkbox => {
                checkbox.checked = false;
            });
            
            // Clear GPS data
            state.gpsLocation = null;
            const gpsIcon = document.getElementById('gps_icon');
            const gpsStatus = document.getElementById('gps_status');
            const gpsCoords = document.getElementById('gps_coords');
            const gpsBtn = document.getElementById('gps_capture_btn');
            
            if (gpsIcon) gpsIcon.className = 'gps-icon';
            if (gpsStatus) gpsStatus.textContent = 'Click button to capture GPS location (Optional - 2 minute timeout)';
            if (gpsCoords) gpsCoords.textContent = '';
            if (gpsBtn) gpsBtn.textContent = 'üìç CAPTURE GPS LOCATION';
            
            // Clear GPS hidden inputs
            const gpsLatInput = document.getElementById('gps_latitude');
            const gpsLonInput = document.getElementById('gps_longitude');
            const gpsAccInput = document.getElementById('gps_accuracy');
            const gpsTimeInput = document.getElementById('gps_timestamp');
            
            if (gpsLatInput) gpsLatInput.value = '';
            if (gpsLonInput) gpsLonInput.value = '';
            if (gpsAccInput) gpsAccInput.value = '';
            if (gpsTimeInput) gpsTimeInput.value = '';
            
            // Reset form status
            if (resetStatus) {
                state.formStatus = 'draft';
                state.currentDraftId = null;
                state.currentDraftName = null;
                document.getElementById('form_status').value = 'draft';
                document.getElementById('draft_id').value = '';
            }
            
            // Reset to section 1
            state.currentSection = 1;
            document.querySelectorAll('.form-section').forEach(section => section.classList.remove('active'));
            const section1 = document.querySelector('.form-section[data-section="1"]');
            if (section1) {
                section1.classList.add('active');
            }
            
            updateProgress();
            updateSubmitButton();
            window.scrollTo({ top: 0, behavior: 'smooth' });
            
            // Re-initialize signature pads
            setTimeout(() => {
                initializeSignaturePads();
            }, 100);
        }

        function showNotification(message, type) {
            const notification = document.getElementById('notification');
            const text = document.getElementById('notificationText');
            
            notification.className = `notification ${type} show`;
            text.textContent = message;

            setTimeout(() => {
                notification.classList.remove('show');
            }, 4000);
        }

        // ============================================
        // SIGNATURE PAD FUNCTIONS
        // ============================================
        function initializeSignaturePads() {
            const canvases = document.querySelectorAll('.signature-canvas');
            
            canvases.forEach(canvas => {
                const fieldName = canvas.getAttribute('data-field');
                
                // Set canvas size
                const container = canvas.parentElement;
                canvas.width = container.offsetWidth - 20;
                canvas.height = 150;
                
                // Initialize SignaturePad
                const signaturePad = new SignaturePad(canvas, {
                    backgroundColor: 'rgb(255, 255, 255)',
                    penColor: 'rgb(0, 0, 0)',
                    minWidth: 1,
                    maxWidth: 3
                });
                
                // Store reference
                state.signaturePads[fieldName] = signaturePad;
                
                // Update hidden input when signature changes
                signaturePad.addEventListener('endStroke', () => {
                    const hiddenInput = document.getElementById(fieldName);
                    if (hiddenInput) {
                        hiddenInput.value = signaturePad.toDataURL();
                    }
                });
            });
        }

        function clearSignature(fieldName) {
            const signaturePad = state.signaturePads[fieldName];
            if (signaturePad) {
                signaturePad.clear();
                const hiddenInput = document.getElementById(fieldName);
                if (hiddenInput) {
                    hiddenInput.value = '';
                }
            }
        }

        function resizeSignaturePads() {
            Object.keys(state.signaturePads).forEach(fieldName => {
                const canvas = document.getElementById(`${fieldName}_canvas`);
                if (canvas && canvas.parentElement) {
                    const signaturePad = state.signaturePads[fieldName];
                    const data = signaturePad.toData();
                    
                    const container = canvas.parentElement;
                    canvas.width = container.offsetWidth - 20;
                    canvas.height = 150;
                    
                    signaturePad.fromData(data);
                }
            });
        }

        // Resize signature pads on window resize
        window.addEventListener('resize', resizeSignaturePads);

        // ============================================
        // GPS FUNCTIONS
        // ============================================
        function captureGPS() {
            const statusIcon = document.getElementById('gps_icon');
            const statusText = document.getElementById('gps_status');
            const coordsText = document.getElementById('gps_coords');
            const captureBtn = document.getElementById('gps_capture_btn');
            
            if (!navigator.geolocation) {
                showNotification('GPS not supported by your browser', 'error');
                if (statusIcon) statusIcon.classList.add('error');
                if (statusText) statusText.textContent = 'GPS not supported';
                return;
            }
            
            // Show loading state
            if (statusIcon) {
                statusIcon.classList.remove('success', 'error');
                statusIcon.classList.add('loading');
            }
            if (statusText) statusText.textContent = 'Capturing GPS location...';
            if (captureBtn) {
                captureBtn.disabled = true;
                captureBtn.textContent = '‚è≥ CAPTURING...';
            }
            
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    // Success
                    const latitude = position.coords.latitude;
                    const longitude = position.coords.longitude;
                    const accuracy = position.coords.accuracy;
                    const timestamp = new Date(position.timestamp).toISOString();
                    
                    // Store in state
                    state.gpsLocation = {
                        latitude,
                        longitude,
                        accuracy,
                        timestamp
                    };
                    
                    // Update hidden inputs
                    const latInput = document.getElementById('gps_latitude');
                    const lonInput = document.getElementById('gps_longitude');
                    const accInput = document.getElementById('gps_accuracy');
                    const timeInput = document.getElementById('gps_timestamp');
                    
                    if (latInput) latInput.value = latitude;
                    if (lonInput) lonInput.value = longitude;
                    if (accInput) accInput.value = accuracy;
                    if (timeInput) timeInput.value = timestamp;
                    
                    // Update UI
                    if (statusIcon) {
                        statusIcon.classList.remove('loading', 'error');
                        statusIcon.classList.add('success');
                    }
                    if (statusText) statusText.textContent = 'GPS location captured successfully!';
                    if (coordsText) coordsText.textContent = `Lat: ${latitude.toFixed(6)}, Lon: ${longitude.toFixed(6)} (¬±${Math.round(accuracy)}m)`;
                    if (captureBtn) {
                        captureBtn.disabled = false;
                        captureBtn.textContent = '‚úì GPS CAPTURED';
                    }
                    
                    showNotification('GPS location captured successfully', 'success');
                },
                (error) => {
                    // Error
                    if (statusIcon) {
                        statusIcon.classList.remove('loading', 'success');
                        statusIcon.classList.add('error');
                    }
                    
                    let errorMessage = 'Failed to capture GPS location';
                    switch(error.code) {
                        case error.PERMISSION_DENIED:
                            errorMessage = 'GPS permission denied. Please enable location access.';
                            break;
                        case error.POSITION_UNAVAILABLE:
                            errorMessage = 'GPS position unavailable. Please try again.';
                            break;
                        case error.TIMEOUT:
                            errorMessage = 'GPS request timed out. Please try again.';
                            break;
                    }
                    
                    if (statusText) statusText.textContent = errorMessage;
                    if (captureBtn) {
                        captureBtn.disabled = false;
                        captureBtn.textContent = 'üìç TRY AGAIN';
                    }
                    
                    showNotification(errorMessage, 'error');
                },
                {
                    enableHighAccuracy: true,
                    timeout: 120000, // 2 minutes (120 seconds)
                    maximumAge: 0
                }
            );
        }

        // Close modals when clicking outside
        document.getElementById('draftsModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeDraftsModal();
            }
        });

        document.getElementById('draftNameModal').addEventListener('click', function(e) {
            if (e.target === this) {
                cancelDraftName();
            }
        });

        document.getElementById('analysisModal').addEventListener('click', function(e) {
            if (e.target === this) {
                closeAnalysisModal();
            }
        });

        // ============================================
        // ANALYSIS DASHBOARD FUNCTIONS
        // ============================================
        async function openAnalysisModal() {
            const modal = document.getElementById('analysisModal');
            const body = document.getElementById('analysisBody');
            
            modal.classList.add('show');
            body.innerHTML = '<div class="analysis-loading"><p>Loading analysis data...</p></div>';
            
            try {
                // Fetch data from Google Apps Script
                const response = await fetch(CONFIG.SCRIPT_URL + '?action=getAnalysis', {
                    method: 'GET'
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    renderAnalysisDashboard(data.data);
                } else {
                    throw new Error(data.message || 'Failed to load data');
                }
            } catch (error) {
                console.error('Analysis error:', error);
                body.innerHTML = `
                    <div class="analysis-error">
                        <p>‚ö†Ô∏è Unable to load analysis data</p>
                        <p style="font-size: 12px; margin-top: 10px;">${error.message}</p>
                        <p style="font-size: 12px; margin-top: 10px;">Please ensure the Google Apps Script is properly deployed and the data sheet contains survey responses.</p>
                    </div>
                `;
            }
        }

        function closeAnalysisModal() {
            document.getElementById('analysisModal').classList.remove('show');
        }

        function renderAnalysisDashboard(data) {
            const body = document.getElementById('analysisBody');
            
            // Create dashboard HTML
            let html = `
                <!-- KEY STATISTICS -->
                <div class="dashboard-grid">
                    <div class="stat-card">
                        <div class="stat-label">TOTAL SUBMISSIONS</div>
                        <div class="stat-value">${data.totalSubmissions}</div>
                        <div class="stat-sublabel">Media institutions surveyed</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">TOTAL EMPLOYEES</div>
                        <div class="stat-value">${data.totalEmployees.toLocaleString()}</div>
                        <div class="stat-sublabel">Across all media houses</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">FEMALE EMPLOYEES</div>
                        <div class="stat-value">${data.femalePercentage}%</div>
                        <div class="stat-sublabel">${data.totalFemale.toLocaleString()} out of ${data.totalEmployees.toLocaleString()}</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-label">WOMEN IN LEADERSHIP</div>
                        <div class="stat-value">${data.leadershipFemalePercentage}%</div>
                        <div class="stat-sublabel">${data.leadershipFemale} out of ${data.totalLeadership} positions</div>
                    </div>
                </div>

                <!-- MEDIA TYPE DISTRIBUTION -->
                <div class="chart-container">
                    <div class="chart-title">MEDIA TYPE DISTRIBUTION</div>
                    <canvas id="mediaTypeChart" class="chart-canvas"></canvas>
                </div>

                <!-- REGIONAL DISTRIBUTION -->
                <div class="chart-container">
                    <div class="chart-title">REGIONAL DISTRIBUTION</div>
                    <canvas id="regionalChart" class="chart-canvas"></canvas>
                </div>

                <!-- WORKFORCE GENDER COMPOSITION -->
                <div class="chart-container">
                    <div class="chart-title">WORKFORCE GENDER COMPOSITION</div>
                    <canvas id="genderChart" class="chart-canvas"></canvas>
                </div>

                <!-- LEADERSHIP REPRESENTATION -->
                <div class="chart-container">
                    <div class="chart-title">LEADERSHIP REPRESENTATION BY GENDER</div>
                    <canvas id="leadershipChart" class="chart-canvas"></canvas>
                </div>

                <!-- DEPARTMENTAL DISTRIBUTION -->
                <div class="chart-container">
                    <div class="chart-title">GENDER DISTRIBUTION BY DEPARTMENT</div>
                    <canvas id="departmentChart" class="chart-canvas"></canvas>
                </div>

                <!-- BARRIERS TO ENTRY -->
                <div class="chart-container">
                    <div class="chart-title">BARRIERS WOMEN FACE AT ENTRY LEVEL</div>
                    <canvas id="barriersChart" class="chart-canvas"></canvas>
                </div>

                <!-- ATTRITION REASONS -->
                <div class="chart-container">
                    <div class="chart-title">REASONS FOR WOMEN LEAVING</div>
                    <canvas id="attritionChart" class="chart-canvas"></canvas>
                </div>
            `;
            
            body.innerHTML = html;
            
            // Render charts
            setTimeout(() => {
                renderMediaTypeChart(data.mediaTypes);
                renderRegionalChart(data.regions);
                renderGenderChart(data);
                renderLeadershipChart(data);
                renderDepartmentChart(data);
                renderBarriersChart(data.barriers);
                renderAttritionChart(data.attritionReasons);
            }, 100);
        }

        function renderMediaTypeChart(mediaTypes) {
            const ctx = document.getElementById('mediaTypeChart');
            if (!ctx) return;

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(mediaTypes),
                    datasets: [{
                        label: 'Number of Media Houses',
                        data: Object.values(mediaTypes),
                        backgroundColor: '#004080',
                        borderColor: '#004080',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function renderRegionalChart(regions) {
            const ctx = document.getElementById('regionalChart');
            if (!ctx) return;

            new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: Object.keys(regions),
                    datasets: [{
                        data: Object.values(regions),
                        backgroundColor: [
                            '#004080',
                            '#0056b3',
                            '#17a2b8',
                            '#28a745',
                            '#ffc107'
                        ],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'right'
                        }
                    }
                }
            });
        }

        function renderGenderChart(data) {
            const ctx = document.getElementById('genderChart');
            if (!ctx) return;

            new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: ['Female Employees', 'Male Employees'],
                    datasets: [{
                        data: [data.totalFemale, data.totalMale],
                        backgroundColor: ['#dc3545', '#004080'],
                        borderWidth: 2,
                        borderColor: '#ffffff'
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }

        function renderLeadershipChart(data) {
            const ctx = document.getElementById('leadershipChart');
            if (!ctx) return;

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Leadership Positions', 'Non-Leadership Positions'],
                    datasets: [{
                        label: 'Women',
                        data: [data.leadershipFemale, data.nonLeadershipFemale],
                        backgroundColor: '#dc3545',
                        borderWidth: 1
                    }, {
                        label: 'Men',
                        data: [data.leadershipMale, data.nonLeadershipMale],
                        backgroundColor: '#004080',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function renderDepartmentChart(data) {
            const ctx = document.getElementById('departmentChart');
            if (!ctx) return;

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Technical Unit', 'Operations/Admin/HR', 'Newsroom/Field'],
                    datasets: [{
                        label: 'Women',
                        data: [data.technicalFemale, data.operationsFemale, data.newsroomFemale],
                        backgroundColor: '#dc3545',
                        borderWidth: 1
                    }, {
                        label: 'Men',
                        data: [data.technicalMale, data.operationsMale, data.newsroomMale],
                        backgroundColor: '#004080',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            position: 'top'
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true
                        }
                    }
                }
            });
        }

        function renderBarriersChart(barriers) {
            const ctx = document.getElementById('barriersChart');
            if (!ctx) return;

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(barriers),
                    datasets: [{
                        label: 'Number of Organizations',
                        data: Object.values(barriers),
                        backgroundColor: '#ffc107',
                        borderColor: '#ffc107',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        function renderAttritionChart(reasons) {
            const ctx = document.getElementById('attritionChart');
            if (!ctx) return;

            new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: Object.keys(reasons),
                    datasets: [{
                        label: 'Number of Organizations',
                        data: Object.values(reasons),
                        backgroundColor: '#dc3545',
                        borderColor: '#dc3545',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    indexAxis: 'y',
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        x: {
                            beginAtZero: true,
                            ticks: {
                                stepSize: 1
                            }
                        }
                    }
                }
            });
        }

        init();
    </script>
</body>
</html>
